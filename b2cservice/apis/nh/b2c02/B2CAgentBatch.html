<html>
<head>
    <title>农行网上支付平台-商户接口示例-委托扣款批量扣款</title>
</head>

<script language="javascript">
	function formatIndex(index) {
		if(index < 10)
			return "00" + index ;
		else if(index >= 10 && index < 100)
			return "0" + index ;
		else
			return index ;
	}
	function addLine() {
		var kc = event.keyCode ;
		if(kc != 13)
			return false ;
		var count = form1.AgentCount.value ;
		if(isNaN(count)) {
			alert("批次总笔数请输入数字！") ;
			return false ;
		}
		count = parseInt(count) ;
		for(var i = 1 ; i <= count ; i++) {
			var index = formatIndex(i) ;
			var row = batch.insertRow() ;
			for(var j = 0 ; j < 8  ; j++) {
				var col = row.insertCell() ;
				switch(j) {
				case 0 :
					col.align = "left" ;
					col.height = "30" ;
					col.innerHTML = "<input type=\"text\" name=\"orderno[]\" style=\"width:95%\" value=\""+ form1.BatchNo.value + index+ "\">" ;
					break ;
				case 1 :
					col.align = "center" ;
					col.innerHTML = "<input type=\"text\" name=\"orderamount[]\" style=\"width:95%\" value=\"1.00\">" ;
					break ;
				case 2 :
					col.align = "center" ;
					col.innerHTML = "<input type=\"text\" name=\"certificateno[]\" style=\"width:95%\" value=\"510230198307191135\">" ;
					break ;
				case 3 :
					col.align = "center" ;
					col.innerHTML = "<input type=\"text\" name=\"contractid[]\" style=\"width:95%\" value=\"ON2009052500100\">" ;
					break ;
				case 4 :
					col.align = "center" ;
					col.innerHTML = "<input type=\"text\" name=\"productid[]\" style=\"width:95%\" value=\"ProductID\">" ;
					break ;
				case 5 :
					col.align = "center" ;
					col.innerHTML = "<input type=\"text\" name=\"productname[]\" style=\"width:95%\" value=\"ProductName\">" ;
					break ;
				case 6 :
					col.align = "center" ;
					col.innerHTML = "<input type=\"text\" name=\"productnum[]\" style=\"width:95%\" value=\"1\">" ;
					break ;
                    case 7 :
					col.align = "center" ;
					col.innerHTML = "<input type=\"text\" name=\"expireddate[]\" style=\"width:95%\" value=\"30\">" ;
					break ;
				}
				
			}			
		}
		form1.payment.disabled = "" ;
	}
	function submitFun() {
		
		form1.submit() ;
	}
</script>

<body bgcolor='#FFFFFF' text='#000000' link='#0000FF' vlink='#0000FF' alink='#FF0000'>
    <center>
        委托扣款批量</center>
    <form name='form1' action='B2CAgentBatch.php' method='POST'>
        <table width="100%">
            <tr>
                <td>
                    批次编号</td>
                <td>
                    <input name='BatchNo' value='1'>*必须</td>
            </tr>
            <tr>
                <td>
                    批次日期</td>
                <td>
                    <input name='BatchDate' value='20090527'>
                    *必须，日期格式要求为YYYYMMDD</td>
            </tr>
            <tr>
                <td>
                    批次总笔数</td>
                <td>
                    <input name='AgentCount' value='10' onkeyup="addLine()">
                    *必须</td>
            </tr>
            <tr>
                <td>
                    批次总金额</td>
                <td>
                    <input name='AgentAmount' value='10.00'>
                    *必须</td>
            </tr>
            <tr>
                <td colspan="2">
                    <table border="1" style="font-size: 17px;" width="100%" id="batch">
                        <tr>
                            <td width="15%" align="center">
                                账单编号</td>
                            <td width="15%" align="center">
                                账单金额</td>
                            <td width="15%" align="center">
                                证件号码</td>
                            <td align="center">
                                签约协议号</td>
                            <td align="center" width="15%">
                                商品编号</td>
                            <td align="center" width="10%">
                                商品名称</td>
                            <td align="center" width="10%">
                                商品数量</td>
                            <td align="center" width="16%">
                                订单有效期</td>
                            <tr>
                    </table>
                </td>
            </tr>
            <tr>
                <td colspan="2">
                    <input type='button' value='批量提交' name="payment" disabled="disabled" onclick="submitFun()"></td>
            </tr>
        </table>
    </form>
    <center>
        <a href='Merchant.html'>回商户首页</a></center>
</body>
</html>
